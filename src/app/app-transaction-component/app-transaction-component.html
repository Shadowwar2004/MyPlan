<!-- src/app/components/transaction-form/transaction-form.component.html -->
<div class="form-container">
  <div class="form-header">
    <h1>Nouvelle Transaction</h1>
  </div>

  <form [formGroup]="transactionForm" (ngSubmit)="onSubmit()" class="transaction-form">

    <!-- Date -->
    <div class="form-group">
      <label for="date">Date:</label>
      <input
        type="date"
        id="date"
        formControlName="date"
        class="form-control"
        [class.error]="transactionForm.get('date')?.invalid && transactionForm.get('date')?.touched">
    </div>

    <!-- Montant -->
    <div class="form-group">
      <label for="amount">Montant:</label>
      <input
        type="number"
        id="amount"
        formControlName="amount"
        step="0.01"
        min="0.01"
        class="form-control"
        placeholder="0.00"
        [class.error]="transactionForm.get('amount')?.invalid && transactionForm.get('amount')?.touched">
      @if (transactionForm.get('amount')?.invalid && transactionForm.get('amount')?.touched) {
        <div class="error-message">
          Le montant est requis et doit être supérieur à 0.
        </div>
      }
    </div>

    <!-- Type (Revenu/Dépenses) -->
    <div class="form-group">
      <label>Type:</label>
      <div class="radio-group">
        <label class="radio-option">
          <input
            type="radio"
            formControlName="type"
            value="expense">
            <!--(change)="onTypeChange()">-->
          <span class="radio-custom expense">Dépenses</span>
        </label>
        <label class="radio-option">
          <input
            type="radio"
            formControlName="type"
            value="income">
            <!--(change)="onTypeChange()">-->
          <span class="radio-custom income">Revenu</span>
        </label>
      </div>
    </div>

    <div class="form-divider"></div>

    <!-- Catégorie -->
    <div class="form-group">
      <label for="category">Catégorie:</label>
      <select
        id="category"
        formControlName="category"
        class="form-control"
        [class.error]="transactionForm.get('category')?.invalid && transactionForm.get('category')?.touched">
        <option value="">Sélectionnez une catégorie</option>
        @for (category of categories; track category.id) {
          <option [value]="category.name">
            {{ category.name }}
          </option>
        }
      </select>
      @if (transactionForm.get('category')?.invalid && transactionForm.get('category')?.touched) {
        <div class="error-message">
          La catégorie est requise.
        </div>
      }
    </div>

    <!-- Sous-catégorie -->
    <div class="form-group">
      <label for="subcategory">Sous-Catégorie:</label>
      <select
        id="subcategory"
        formControlName="subcategory"
        class="form-control"
        [class.error]="transactionForm.get('subcategory')?.invalid && transactionForm.get('subcategory')?.touched"
        [disabled]="!transactionForm.get('category')?.value">
        <option value="">Sélectionnez une sous-catégorie</option>
        @for (subcategory of subcategories; track subcategory) {
          <option [value]="subcategory">
            {{ subcategory }}
          </option>
        }
      </select>
      @if (transactionForm.get('subcategory')?.invalid && transactionForm.get('subcategory')?.touched) {
        <div class="error-message">
          La sous-catégorie est requise.
        </div>
      }
      <div class="help-text" [class.active]="!transactionForm.get('category')?.value">
        @if (!transactionForm.get('category')?.value) {
          Veuillez sélectionner une catégorie pour voir les sous-catégories
        } @else {
          Sélectionnez une sous-catégorie
        }
      </div>
    </div>

    <!-- Description -->
    <div class="form-group">
      <label for="description">Description (optionnel):</label>
      <textarea
        id="description"
        formControlName="description"
        class="form-control"
        placeholder="Description de la transaction..."
        rows="3"></textarea>
    </div>

    <!-- Bouton Ajouter -->
    <div class="form-actions">
      <button
        type="submit"
        class="btn-primary"
        [disabled]="!transactionForm.valid">
        Ajouter
      </button>
    </div>

    <!-- Message de succès -->
    @if (showSuccessMessage) {
      <div class="success-message">
        Transaction ajoutée avec succès !
      </div>
    }
  </form>
</div>
